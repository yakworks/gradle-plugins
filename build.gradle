// First, apply the publishing plugin
buildscript {
  repositories {
    mavenLocal()        // for downstream test
    maven { url "https://plugins.gradle.org/m2/" }
  }
  dependencies {
    classpath 'org.shipkit:shipkit:2.0.22'
    classpath 'ru.vyarus:gradle-animalsniffer-plugin:+'
    classpath 'io.spring.gradle:dependency-lock:latest.release'
  }
}
plugins {
  id "com.dorongold.task-tree" version "1.3"
}
apply plugin: 'idea'
apply plugin: 'groovy'
apply plugin: 'org.shipkit.gradle-plugin'
apply plugin: 'com.gradle.plugin-publish'
apply plugin: 'spring.lock' //run gradle updateLocks

group = 'org.yakworks'

repositories {
  jcenter()
  maven { url "https://plugins.gradle.org/m2/" }
}

//run `gradle updateLocks` to update the locks below to highest versionusing the + notation
dependencies {
  // gradle
  compile gradleApi()
  compile localGroovy()

  runtime 'org.ajoberstar:grgit:+' lock '2.2.0'
  runtime 'org.ajoberstar:gradle-git-publish:+' lock '0.4.0'
  // 3rd party plugins
  runtime 'com.diffplug.spotless:spotless-plugin-gradle:+' lock '3.10.0'
  runtime "gradle.plugin.com.energizedwork:idea-gradle-plugins:+" lock '1.4'
  runtime "gradle.plugin.com.palantir.configurationresolver:gradle-configuration-resolver-plugin:0.2.0"
  compile 'org.shipkit:shipkit:2.+' lock '2.0.22'
  //runtime 'com.netflix.nebula:gradle-lint-plugin:+'
}

pluginBundle {
  website = 'https://github.com/yakworks/gradle-plugins'
  vcsUrl = 'https://github.com/yakworks/gradle-plugins.git'
  description = 'Plugin providing opinionated defaults and shipkit setup for Groovy, Grails and Gradle library/plugin projects. Enables hooks for automated releases and versioning and tags with CircleCI. '
  tags = ['grails', 'groovy', 'shipkit', 'circleCI', 'continuous delivery', 'release', 'defaults']
  // plugins {
  //     publishPlugin {
  //         id = 'org.ajoberstar.defaults'
  //         displayName = 'ajoberstar Defaults Plugin'
  //         tags = ['defaults']
  //     }
  // }
  mavenCoordinates {
    groupId = project.group
    artifactId = project.name
    version = project.version
  }
}

wrapper {
  gradleVersion = '4.6'
}

// spotless.formats.groovy.target 'src/main/groovy/**/*.groovy'
// gradleLint.excludedRules = ['transitive-duplicate-dependency-class']

tasks.create('foo'){
  doLast{
    println "GOT IT"
  }
}
